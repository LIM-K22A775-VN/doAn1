<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>html Page</title>
    <link rel="stylesheet" href="../static/CssTotal/standard.css" />
    <link rel="stylesheet" href="../static/CssTotal/stylesignup.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.0/css/all.min.css" />
    <script src="../static/CssTotal/standard.js"></script>

    <style>
        .login-container {
            width: 510px;
        }

        .webcam-button {
            background-color: #ff6200;
            color: #fff;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            width: 116px;
            margin-bottom: 20px;
        }
        .navbar_right {
            margin-top: -3px;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>

<body>
    <header class="header">
        <img class="logo" src="../static/avatars/media/logo2.png" alt="logo" />
        <div class="navbar">
            <div class="navbar_item">
                <a href="intro.html">Trang chủ</a>
            </div>
            <div class="navbar_item">
                <a href="refarral.html">Giới thiệu</a>
            </div>
            <div class="navbar_item">
                <a href="Menu.html">Thực đơn</a>
            </div>
            <div class="navbar_item">
                <a href="#">Bài viết</a>
            </div>
            <div class="navbar_item">
                <a href="#">Hình ảnh</a>
            </div>
            <div class="navbar_item">
                <a href="#">Liên hệ</a>
            </div>
        </div>
        <div class="navbar_right">
            <div class="navbar_item navbar_item_right">
                <a href="reserve.html">
                    <i class="fa-solid fa-calendar-check navbar_icon"></i>
                    Đặt bàn</a>
            </div>
            <div class="navbar_item navbar_item_right account-dropdown" id="accountDropdown">
                <div class="account-toggle" onclick="toggleDropdown()">
                    <i class="fa-solid fa-user navbar_icon"></i> Tài khoản
                </div>
                <ul class="dropdown-menu" id="dropdownMenu">
                    <li><i class="fa-solid fa-user"></i> Hồ sơ</li>
                    <li><i class="fa-solid fa-calendar-check"></i> Đặt bàn</li>
                    <li><i class="fa-solid fa-box"></i> Đơn hàng</li>
                    <li><i class="fa-solid fa-heart"></i> Yêu thích</li>
                    <li><i class="fa-solid fa-right-from-bracket"></i> Đăng xuất</li>
                </ul>
            </div>
            <div class="navbar_item navbar_item_right">
                <a href="Cart.html">
                    <i class="fa-solid fa-cart-shopping navbar_icon"></i>
                    Giỏ hàng</a>
            </div>
        </div>
    </header>

    <div class="inner-position">
        <p>Bạn đang ở đây: =></p>
        <a href="intro.html">Trang chủ =></a>
        <span style="color: black;margin-left: 1px;">Đăng ký</span>
    </div>

    <div class="container">
        <div class="login-container">
            <h2>Đăng ký</h2>
            <form action="/register-send-otp" method="post" enctype="multipart/form-data" id="signupForm">
                <label for="username">Họ Và Tên</label>
                <input type="text" id="username" name="username" required>

                <label for="address">Địa chỉ</label>
                <input type="text" id="address" name="address" required>

                <label for="email">Email</label>
                <input type="email" id="email" name="email" placeholder="ex. name@gmail.com" required>
                <p class="temp">Email sẽ được bảo mật.</p>

                <label for="phone">Số điện thoại</label>
                <input type="tel" id="phone" name="phone" required>

                <label>Giới tính</label>
                <div class="gender-group">
                    <input type="radio" id="male" name="gender" value="Nam" required>
                    <label for="male">Nam</label>
                    <input type="radio" id="female" name="gender" value="Nữ">
                    <label for="female">Nữ</label>
                </div>

                <label for="role">Vai trò</label>
                <select id="role" name="role" required  style="height: 30px; margin-bottom: 20px;">
                    <option value="user">Người dùng</option>
                    <option value="staff">Nhân viên</option>
                </select>

                <input type="file" id="avatar" name="avatar" accept="image/*">
                <input type="hidden" id="avatar_name" name="avatar_name">

                <!-- KHU VỰC FaceID -->
                <label>Chụp ảnh Face ID</label>
                <div id="faceid-section">
                    <video id="video" width="320" height="240" autoplay
                        style="border: 1px solid #000; display: none;"></video>
                    <br>
                    <button type="button" id="snap" class="btn webcam-button">Bật webcam</button>
                    <canvas id="canvas" name="faceid_canvas" width="320" height="240"
                        style="display:none; border:1px solid #000;"></canvas>
                </div>
                <input type="hidden" id="faceid_image" name="faceid_image">

                <label for="password">Tạo mật khẩu</label>
                <input type="password" id="password" name="password" required>

                <label for="confirmPassword">Nhập lại mật khẩu</label>
                <input type="password" id="confirmPassword" name="confirmPassword" required>

                <button type="submit" class="btn login">Đăng ký</button>
            </form>

            <p class="register">Bạn đã có tài khoản ? <a href="/login">Đăng nhập</a></p>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-left">
                <h3>Nhà hàng Lẩu Hột Ty Hưu Trung Thạnh</h3>
                <p>Nhà hàng chuyên về các món lẩu ngon nhất tại Thành phố Hải Phòng, chuyên về các món ăn chuẩn hương vị
                    thuần Việt.</p>
                <p>Thực phẩm tươi sống là yếu tố hàng đầu trong việc chế biến món ăn, Quy Khắc chắc chắn sẽ làm hài lòng
                    quý khách với những món ăn đậm đà hương vị.</p>
            </div>
            <div class="footer-right">
                <h3>Thông tin liên hệ</h3>
                <p><i class="fas fa-map-marker-alt"></i> Địa chỉ: Hà Đông, Hà Nội</p>
                <p><i class="fas fa-phone"></i> Điện thoại: 0999999999</p>
                <p><i class="fas fa-envelope"></i> Email: dabc@gmail.com</p>
                <button class="footer-book-now">Đặt bàn ngay</button>
                <div class="footer-social">
                    <a href="https://www.facebook.com/" target="_blank"><i class="fab fa-facebook-f"></i></a>
                    <a href="tel:0999999999"><i class="fas fa-phone"></i></a>
                    <a href="https://www.pinterest.com/" target="_blank"><i class="fab fa-pinterest-p"></i></a>
                    <a href="https://plus.google.com/" target="_blank"><i class="fab fa-google-plus-g"></i></a>
                </div>
            </div>
        </div>
    </footer>

    <!-- SCRIPT XỬ LÝ -->
    <script>
        const video = document.getElementById('video');
        const snapBtn = document.getElementById('snap');
        const canvas = document.getElementById('canvas');
        const faceidInput = document.getElementById('faceid_image');
        let streamStarted = false;

        snapBtn.onclick = () => {
            if (!streamStarted) {
                navigator.mediaDevices.getUserMedia({
                        video: true
                    })
                    .then(stream => {
                        video.srcObject = stream;
                        video.style.display = 'block';
                        snapBtn.textContent = 'Chụp ảnh';
                        streamStarted = true;
                    })
                    .catch(err => {
                        console.error("Lỗi webcam:", err);
                        alert("Không thể bật webcam!");
                    });
            } else {
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                canvas.style.display = 'block';
                faceidInput.value = canvas.toDataURL('image/jpeg'); // ✅ Sửa lỗi ở đây

                // Dừng webcam
                if (video.srcObject) {
                    let tracks = video.srcObject.getTracks();
                    tracks.forEach(track => track.stop());
                    video.style.display = 'none';
                    snapBtn.textContent = 'Bật webcam';
                    streamStarted = false;
                }
                alert("Đã chụp xong!");
            }
        };
    </script>
    <script>
        document.getElementById('signupForm').addEventListener('submit', function (e) {
            const pw = document.getElementById('password').value;
            const cpw = document.getElementById('confirmPassword').value;

            if (pw !== cpw) {
                alert("Mật khẩu không khớp!");
                e.preventDefault();
            }
        });
    </script>